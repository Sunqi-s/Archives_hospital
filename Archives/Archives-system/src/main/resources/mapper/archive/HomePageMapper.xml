<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.archives.archive.mapper.HomePageMapper">

    <select id="thisMonth" resultType="java.lang.Integer">
        SELECT COUNT(*)
        FROM archive_info
        WHERE MONTH(create_time) = MONTH(CURRENT_DATE())
          AND YEAR(create_time) = YEAR(CURRENT_DATE())
          AND archive_status = #{archiveStatus}
    </select>
    <select id="lastMonth" resultType="java.lang.Integer">
        SELECT COUNT(*)
        FROM archive_info
        WHERE MONTH(create_time) = MONTH(CURRENT_DATE() - INTERVAL 1 MONTH)
          AND YEAR(create_time) = YEAR(CURRENT_DATE() - INTERVAL 1 MONTH)
          AND archive_status = #{archiveStatus}
    </select>
    <select id="thisYear" resultType="java.lang.Integer">
        SELECT COUNT(*)
        FROM archive_info
        WHERE YEAR(create_time) = YEAR(CURRENT_DATE())
          AND archive_status = #{archiveStatus}
    </select>
    <select id="all" resultType="java.lang.Integer">
        SELECT COUNT(*)
        FROM archive_info
        WHERE archive_status = #{archiveStatus}
    </select>
    <select id="selectHomeData" resultType="java.lang.Integer">
        SELECT COUNT(*)
        FROM archive_info
        WHERE category_id = #{categoryId}
    </select>
    <select id="importData1" resultType="com.archives.archive.domain.HomeData">
        select
            DAY(create_time) as time,
            SUM(info_processed_records) as value
            FROM archive_import_log
            WHERE YEAR(create_time) = YEAR(CURRENT_DATE()) AND type in ('dandao','bendi','zaixian')
            GROUP BY Day(create_time)
            ORDER BY Day(create_time)
    </select>
    <select id="importData2" resultType="com.archives.archive.domain.HomeData">
        select
            DAY(create_time) as time,
            SUM(info_processed_records) as value
        FROM archive_import_log
        WHERE YEAR(create_time) = YEAR(CURRENT_DATE()) AND type in ('luru')
        GROUP BY Day(create_time)
        ORDER BY Day(create_time)
    </select>
    <select id="importOss" resultType="java.lang.Integer">
        select
            SUM(oss_processed_records) as value
        FROM archive_import_log
    </select>
</mapper>
